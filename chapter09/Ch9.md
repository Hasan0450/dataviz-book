**Chapter 9**

All figures were made in R and [the code is here](Ch8.R). Figures 9.2, 9.4, 9.5, 9.7 and 9.8 were made by other people.
Figure 9.1 is a connected scatterplot where the color of each part of the line is determined by the antiquity of the data. There are also series for Scotland and Non-Scotland, so that make four dimensions or variables. I made it aeons ago, and the presence of an integer called `frametime` rather suggests that I might have considered making an animation (though I never did). The code is [here](elections.R) and the data are [here](elections_wide.csv). The data are in the public domain, via Wikipedia possibly. The three components are converted to a horizontal and a vertical dimension. The markers for elections, and the lines joining them, are added incrementally by loops, changing the colour each time. There may be a more loop-averse approach. The smooth curves are made by getting splines of the horizontal dimension (Lab v Con) through time, and the same for the vertical dimension (Two-Party System v Others) through time, then sticking the predicted horizontal and vertical values together. Another example of this use of splines is in [this video](https://www.youtube.com/watch?v=kqIl4I8PlBM).

[Figure 9.3](9-timeline2.svg) was assembled in Inkscape. One mistake I made there was transforming three existing line charts with a huge vertical stretch, which thickened the lines in a vertical direction, so you get the look of a calligraphy pen, if you know what I mean. Not a disaster, but a simple mistake impacting slightly on style. The constituent parts were three line charts ([HIV](9-timeline-hiv.svg), [nukes](9-timeline-nuc.svg) and [ozone](9-timeline-ozo.svg)). Data for [HIV](HIV-population.csv) and [nukes](nuclear-warheads.csv) were downloaded (from the World Bank and the Bulletin of Atomic Scientists respectively) and tidied into CSV files. Ozone data were extracted from [this image file](halley-ozone.JPG) from the British Antarctic Survey. You can see how in the R script. Country outlines were obtained as SVGs from Wikimedia Commons. The whole thing was compiled in Inkscape.

[Figure 9.6](9-autocorr.svg) is an standard statistical autocorrelation plot, obtained from the train delays data (code [here](../chapter02/traindelays-4weeks.R): a one-liner `plot(acf(trains$london_se,ci=(-1)),main='')`).
